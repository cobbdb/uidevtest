var Util={parseQuery:function(query){query=decodeURIComponent(query);query=query.slice(1);var result={};var params=query.split("&");for(var i in params){var pair=params[i].split("=");result[pair.shift()]=pair.join("=")}return result},parseStoryId:function(id){return parseInt(id.slice(-2))},splitStory:function(story){var len=story.length;var offset=story.slice(len/2).search(/<p>/i);var half=len/2+offset;return[story.slice(0,half),story.slice(half)]}};Date.prototype.toString=function(){var hour=this.getHours()%13;hour=(hour==0)?12:hour;var min=this.getMinutes().toString();min=(min.length==1)?"0"+min:min;var code=(this.getHours()<12)?" a.m. ":" p.m. ";return(hour+":"+min+code+Date.DAYS[this.getDay()]+", "+Date.MONTHS[this.getMonth()]+" "+this.getDate()+", "+this.getFullYear())};Date.MONTHS=["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."];Date.DAYS=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];$(function(){$.ajax({url:"../js/uidevtest-data.js",dataType:"json",type:"GET",success:function(res){var showList=true;var query=Util.parseQuery(window.location.search);if(query.story){var id=Util.parseStoryId(query.story);if(id>0&&id<=res.objects.length){showList=false}}if(showList){var view=new EJS({url:"views/list.ejs"});var markup=view.render(res);$("#page").html(markup)}else{var view=new EJS({url:"views/story.ejs"});var markup=view.render(res.objects[id-1]);$("#page").html(markup)}},error:function(xhr){console.error(xhr.status+" : "+xhr.statusText);$("#page").append("The site has failed to load :[ Please refresh the page.")},beforeSend:function(){$("<img/>",{id:"loadBar",alt:"Loading",src:"../images/loading.gif"}).appendTo("#page")},complete:function(){$("#loadBar").remove()}})});